<div class="flex min-h-screen w-full bg-background-light dark:bg-background-dark">
  <!-- Sidebar -->
  <aside [class.w-64]="sidebarOpen" [class.w-0]="!sidebarOpen" 
         class="flex-shrink-0 bg-white dark:bg-gray-900/50 p-4 flex flex-col justify-between border-r border-gray-200 dark:border-gray-800 transition-all duration-300 overflow-hidden">
    <div>
      <!-- Logo -->
      <div class="flex items-center gap-3 p-2 mb-6">
        <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-lg size-10" 
             style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuCxO-GXIAyAfF7RWp_EVAwv-NkIrI-xJ9WoNVoVMlVCEdpqkqprqwkjFIuD4Yb6WS7Lo8oR4w6cAkPZjZ9evO8BTCa6cnycm5LSTYMM__R_Nlwf3HGbAwJslPI5y6UKUjxdyszH5RvfqpflKMMqyN3zISR3IC6cDxQIjR9E994ZDj73R9h3qJ2emDXJaVFHrUDwNzdBkZ-O9qwj76I_Vp3pMoSk8XobJPSJJv12SeuZPTFXglxm4WukpNnJ6nYUQ7hxsaO81zKcoeem');"></div>
        <div class="flex flex-col" [class.hidden]="!sidebarOpen">
          <h1 class="text-gray-900 dark:text-white text-base font-bold leading-normal">Minimarket Camucha</h1>
          <p class="text-gray-500 dark:text-gray-400 text-sm font-normal leading-normal">Admin</p>
        </div>
      </div>

      <!-- Navigation -->
      <nav class="flex flex-col gap-2" [class.hidden]="!sidebarOpen">
        @if (permissionsService.canViewDashboard()) {
          <a routerLink="/admin/dashboard" routerLinkActive="bg-primary-admin/10 text-primary-admin" 
             class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-primary-admin/10 hover:text-primary-admin dark:hover:text-primary-admin">
            <span class="material-symbols-outlined">dashboard</span>
            <p class="text-sm font-medium leading-normal">Dashboard</p>
          </a>
        }
        @if (permissionsService.canUsePOS()) {
          <a routerLink="/pos" routerLinkActive="bg-primary-admin/10 text-primary-admin" 
             class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-primary-admin/10 hover:text-primary-admin dark:hover:text-primary-admin">
            <span class="material-symbols-outlined">point_of_sale</span>
            <p class="text-sm font-medium leading-normal">Punto de Venta</p>
          </a>
        }
        @if (permissionsService.canManageSales()) {
          <a routerLink="/admin/ventas" routerLinkActive="bg-primary-admin/10 text-primary-admin" 
             class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-primary-admin/10 hover:text-primary-admin dark:hover:text-primary-admin">
            <span class="material-symbols-outlined">receipt_long</span>
            <p class="text-sm font-medium leading-normal">Ventas</p>
          </a>
        }
        @if (permissionsService.canManageProducts()) {
          <a routerLink="/admin/productos" [routerLinkActiveOptions]="{exact: false}" routerLinkActive="bg-primary-admin/10 text-primary-admin" 
             class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-primary-admin/10 hover:text-primary-admin dark:hover:text-primary-admin">
            <span class="material-symbols-outlined">inventory_2</span>
            <p class="text-sm font-medium leading-normal">Productos</p>
          </a>
        }
        @if (permissionsService.canManageCustomers()) {
          <a routerLink="/admin/clientes" routerLinkActive="bg-primary-admin/10 text-primary-admin" 
             class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-primary-admin/10 hover:text-primary-admin dark:hover:text-primary-admin">
            <span class="material-symbols-outlined">people</span>
            <p class="text-sm font-medium leading-normal">Clientes</p>
          </a>
        }
        @if (permissionsService.canManageProducts()) {
          <a routerLink="/admin/categorias" [routerLinkActiveOptions]="{exact: false}" routerLinkActive="bg-primary-admin/10 text-primary-admin" 
             class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-primary-admin/10 hover:text-primary-admin dark:hover:text-primary-admin">
            <span class="material-symbols-outlined">category</span>
            <p class="text-sm font-medium leading-normal">Categorías</p>
          </a>
        }
        @if (permissionsService.isAdmin()) {
          <a routerLink="/admin/usuarios" routerLinkActive="bg-primary-admin/10 text-primary-admin" 
             class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-primary-admin/10 hover:text-primary-admin dark:hover:text-primary-admin">
            <span class="material-symbols-outlined">people</span>
            <p class="text-sm font-medium leading-normal">Usuarios</p>
          </a>
        }
      </nav>
    </div>

    <!-- Logout -->
    <div [class.hidden]="!sidebarOpen">
      <a (click)="logout()" 
         class="flex items-center gap-3 px-3 py-2 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-red-500/10 hover:text-red-500 dark:hover:text-red-500 cursor-pointer">
        <span class="material-symbols-outlined">logout</span>
        <p class="text-sm font-medium leading-normal">Cerrar Sesión</p>
      </a>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 flex flex-col overflow-hidden">
    <!-- Header -->
    <header class="flex items-center justify-between whitespace-nowrap border-b border-gray-200 dark:border-gray-700 px-6 py-3 bg-white dark:bg-background-dark/50 flex-shrink-0">
      <div class="flex items-center gap-4 text-gray-900 dark:text-white">
        <button (click)="toggleSidebar()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg">
          <span class="material-symbols-outlined">menu</span>
        </button>
        <div class="size-6 text-primary-admin">
          <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
            <path clip-rule="evenodd" d="M12.0799 24L4 19.2479L9.95537 8.75216L18.04 13.4961L18.0446 4H29.9554L29.96 13.4961L38.0446 8.75216L44 19.2479L35.92 24L44 28.7521L38.0446 39.2479L29.96 34.5039L29.9554 44H18.0446L18.04 34.5039L9.95537 39.2479L4 28.7521L12.0799 24Z" fill="currentColor" fill-rule="evenodd"></path>
          </svg>
        </div>
        <h2 class="text-lg font-bold tracking-tight">Minimarket Camucha</h2>
        <span class="text-sm text-gray-500 dark:text-gray-400 font-medium ml-2">Caja 01</span>
      </div>
      <div class="flex items-center gap-4">
        <span class="text-sm text-gray-600 dark:text-gray-300" data-cy="user-menu">
          Usuario: {{ authService.currentUser()?.username }}
        </span>
        <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" 
             style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuBzj00K22jvV9gfRXmUkPBZ9DXXy5vpjyoCDRFuOm3c8FDewvZ8pcTrCalOneosWGlCMlL9e2p6ZHzGU8KsqNpSggFmZLeHKjGP--Ffa0mur3KSnkq0PfkisB3ijiFRrJdgn62PjMRxv4okkzBAJlmaBGPYVV22DiFAYd6zuY4oUGqUSgI7-jBvhVp5ltSbE-NF-ia3es20-HLLgMqkw37y_lauHy6msLzObilopS4fviDrJWDrmFzOj_MhqRvaKBZ8kA3gLt53WsYf');"></div>
        <button (click)="logout()" 
                data-cy="logout-button"
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 text-sm font-bold leading-normal tracking-wide hover:bg-gray-200 dark:hover:bg-gray-600">
          <span class="truncate">Cerrar Sesión</span>
        </button>
      </div>
    </header>

    <!-- Content Area -->
    <div class="flex-1 overflow-y-auto p-6">
      <router-outlet></router-outlet>
    </div>
  </main>
</div>

